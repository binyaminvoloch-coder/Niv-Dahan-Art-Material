<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <title>Niv Dahan | אמן טדלקט מרוקאי בינלאומי | Art & Material</title>
    <meta name="description" content="ניב דהן, אמן ומומחה עולמי לטדלקט מרוקאי. שחזור ושימור בטיח סיד עתיק בעבודת יד. חיבור לחומר ולנפש.">
    
    <meta property="og:type" content="website">
    <meta property="og:title" content="Niv Dahan | אמן טדלקט מרוקאי בינלאומי | Art & Material">
    <meta property="og:description" content="יוצר, וחוקר אומנויות וטכניקות קישוט עתיקות מבוססות סיד, ומתמחה בשחזור ושימור מבנים בטיח מרוקאי בעבודת יד.">
    <meta property="og:image" content="01.webp">
    <meta property="og:locale" content="he_IL">

    <link rel="canonical" href="                                 " />
    <meta name="google-site-verification" content="YOUR_GOOGLE_VERIFICATION_CODE" />

    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Person",
      "name": "Niv Dahan",
      "jobTitle": "International Moroccan Tadelakt Artist",
      "description": "יוצר, וחוקר אומנויות וטכניקות קישוט עתיקות מבוססות סיד, ומתמחה בשחזור ושימור מבנים בטיח מרוקאי בעבודת יד.",
      "url": "                                 ",
      "image": "01.webp",
      "sameAs": [
        "                                       ",
        "https://www.facebook.com/niv.aviv.5",
        "                                     "
      ],
      "telephone": "+972-53-5379988"
    }
    </script>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Assistant:wght@400;600;700;800&family=Rubik:wght@400;500;700&display=swap');
        
        :root {
            --tadelakt-ochre: #C2825A;
            --tadelakt-beige: #EADCD1;
            --light-bg: #fdfbf7;
            --text-dark: #2d2d2d;
            --text-light-gray: #6b7280;
        }

        html, body { max-width: 100vw; overflow-x: hidden; }

        body {
            font-family: 'Assistant', sans-serif;
            background-color: var(--light-bg);
            color: var(--text-dark);
            scroll-behavior: smooth;
        }

        .serif { font-family: 'Rubik', serif; }
        .text-gradient-tadelakt {
            background: linear-gradient(to right, var(--tadelakt-ochre), #9e6443);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .bg-gradient-tadelakt { background: linear-gradient(to right, var(--tadelakt-ochre), #9e6443); }

        .hero-section {
            position: relative;
            min-height: 100vh;
            overflow: hidden;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.75);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.6);
            box-shadow: 0 8px 32px rgba(0,0,0,0.05);
        }

        .input-light {
            background-color: #ffffff;
            border: 1px solid #e5e7eb;
            color: #333;
            transition: all 0.3s;
        }

        .img-straight {
            overflow: hidden;
            border-radius: 1.5rem;
            box-shadow: 0 20px 40px -10px rgba(0,0,0,0.1);
            position: relative;
            background-color: #eee;
        }

        .img-straight img, .img-straight video { 
            transition: transform 0.7s ease; width: 100%; height: 100%; object-fit: cover; 
        }
        .img-straight:hover img { transform: scale(1.05); }

        .category-overlay {
            background: linear-gradient(to top, rgba(0,0,0,0.7) 0%, transparent 60%);
        }

        #toast { 
            position: fixed; bottom: 20px; right: 20px; transform: translateY(150%); 
            transition: transform 0.3s ease; z-index: 4000; background-color: #333; 
            color: white; padding: 1rem 1.5rem; border-radius: 1rem; border-right: 4px solid var(--tadelakt-ochre); 
            max-width: 90vw; 
        }
        #toast.show { transform: translateY(0); }

        #whatsapp-float { 
            position: fixed; bottom: 25px; left: 25px; z-index: 999; 
            background: #25D366; color: white; width: 60px; height: 60px; 
            border-radius: 50%; display: flex; align-items: center; justify-content: center; 
            box-shadow: 0 4px 20px rgba(0,0,0,0.15); transition: transform 0.2s; 
        }

        @media (max-width: 767px) {
            .footer-social-group { display: flex; justify-content: center; gap: 1.5rem; margin-bottom: 1.5rem; }
        }
    </style>
</head>
<body>

    <div id="toast" class="shadow-2xl flex items-center gap-3 font-bold">
        <i data-lucide="info"></i>
        <span id="toast-msg"></span>
    </div>

    <a href="https://api.whatsapp.com/send/?phone=972535379988&text=היי%20ניב,%20אשמח%20לפרטים%20על%20עבודת%20טדלקט" target="_blank" id="whatsapp-float">
        <i data-lucide="message-circle" class="w-8 h-8"></i>
    </a>

    <nav class="fixed top-0 w-full z-50 p-4 transition-all duration-300">
        <div class="max-w-7xl mx-auto flex justify-between items-center glass-card rounded-full px-4 md:px-6 py-3 shadow-sm">
            <div class="text-lg md:text-xl font-bold tracking-widest serif uppercase text-gradient-tadelakt">Niv Dahan</div>
            <div class="flex gap-3 md:gap-4 items-center">
                <a href="                                         " target="_blank" class="hover:text-pink-600 transition text-gray-600"><i data-lucide="instagram" class="w-5 h-5"></i></a>
                <a href="https://www.facebook.com/niv.aviv.5" target="_blank" class="hover:text-blue-700 transition text-gray-600"><i data-lucide="facebook" class="w-5 h-5"></i></a>
                <a href="                                        " target="_blank" class="hover:text-gray-900 transition text-gray-600"><i data-lucide="at-sign" class="w-5 h-5"></i></a>
            </div>
        </div>
    </nav>

    <!-- Header / Hero Section המעודכן עם הווידאו -->
    <header class="hero-section flex flex-col items-center justify-center text-center px-4 pt-20">
        
        <!-- וידאו רקע -->
        <video autoplay loop muted playsinline class="absolute top-0 left-0 w-full h-full object-cover z-0 pointer-events-none">
            <source src="https://res.cloudinary.com/dl3qhrzk8/video/upload/v1771522364/10_duzwfv.mp4" type="video/mp4">
        </video>

        <!-- שכבת מעבר (גרדיאנט) על הוידאו כדי שהטקסט יבלוט וישתלב עם צבע האתר -->
        <div class="absolute inset-0 z-0 pointer-events-none" style="background: linear-gradient(to bottom, rgba(255,255,255,0.1), rgba(253, 251, 247, 1));"></div>

        <!-- תוכן המסך -->
        <div class="z-10 max-w-4xl space-y-6 mt-10 w-full relative">
            <h1 class="text-5xl md:text-8xl font-bold serif text-[#333] drop-shadow-sm leading-none animate-fade-in-up">
                Niv Dahan<br><span class="text-gradient-tadelakt">Art & Material</span>
            </h1>
            <p class="text-lg md:text-2xl font-light text-gray-600 tracking-wide max-w-2xl mx-auto px-2 hero-title-subtext">
                <i data-lucide="leaf" class="w-6 h-6 text-tadelakt-ochre inline mr-1"></i> International Moroccan Tadelakt Artist
            </p>
            <div class="flex flex-col md:flex-row gap-4 justify-center pt-8">
                <a href="#contact-form" class="bg-[#2d2d2d] text-white font-bold py-4 px-12 rounded-full hover:bg-tadelakt-ochre transition-all shadow-xl transform hover:-translate-y-1">יצירת קשר</a>
            </div>
        </div>
        
        <!-- חץ גלילה למטה -->
        <div class="absolute bottom-10 animate-bounce text-gray-400 z-10"><i data-lucide="chevron-down" class="w-10 h-10"></i></div>
    </header>

    <main class="max-w-7xl mx-auto px-4 py-16 md:py-20 space-y-24 md:space-y-32">
        
        <section class="grid md:grid-cols-2 gap-12 items-center">
            <div class="relative group mx-auto w-full max-w-md md:max-w-full order-2 md:order-1">
                <div class="absolute -inset-4 bg-tadelakt-beige rounded-[2rem] -z-10 rotate-2"></div>
                <div class="img-straight h-[400px] md:h-[500px]">
                    <img src="02.webp" alt="ניב דהן בעבודת טדלקט במבנה עתיק" loading="lazy">
                </div>
            </div>
            <div class="space-y-6 text-right order-1 md:order-2">
                <div class="flex items-center gap-3 justify-end">
                    <span class="w-12 h-1 bg-gradient-tadelakt rounded-full"></span>
                    <span class="text-sm font-bold tracking-widest text-tadelakt-ochre uppercase">האמן והחומר</span>
                </div>
                <h2 class="text-4xl md:text-5xl font-bold serif text-[#2d2d2d]">חיבור ל<span class="text-gradient-tadelakt">עבר</span>, יצירה ל<span class="text-gradient-tadelakt">עתיד</span></h2>
                <div class="text-gray-600 leading-relaxed space-y-4 text-lg font-normal">
                    <p>יוצר וחוקר אומנויות וטכניקות קישוט עתיקות מבוססות סיד, ומתמחה בשחזור ושימור מבנים בטיח מרוקאי בעבודת יד. ניב דהן מביא עמו ידע רב וניסיון עשיר, תוך הקפדה על הפרטים הקטנים ביותר והבנה עמוקה של החומר.</p>
                    <p>"יש משהו בטדלקט שמרפא דרך העשייה. לא כי הוא מטפל, אלא כי הוא מחזיר אותנו לידיים, לנשימה, לקצב. העבודה עם החומר מבקשת נוכחות: להרגיש את הלחות, את ההתנגדות, את הזמן. כל תנועה מדויקת, כל שכבה נבנית לאט, וככה גם בפנים — משהו מסתדר. ריפוי בעיסוק הוא לא רק תוצאה, הוא המפגש בין גוף, חומר ונפש. ובטדלקט, המפגש הזה קורה בשקט, בלי מילים, דרך הידיים. לפעמים, כדי לרפא, לא צריך לדבר. צריך לעשות."</p>
                </div>
            </div>
        </section>

        <section class="space-y-12">
            <div class="text-center">
                <h3 class="text-3xl md:text-4xl font-bold serif mb-4 text-[#2d2d2d]">הקסם של <span class="text-gradient-tadelakt">הפיגמנטים הטבעיים</span></h3>
                <p class="text-gray-500">צבע שנולד מהאדמה</p>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 h-auto md:h-[450px]">
                <div class="img-straight h-[350px] md:h-full relative cursor-pointer" onclick="openLightbox('03.webp')">
                    <img src="03.webp" alt="צבע מהטבע">
                    <div class="absolute bottom-4 right-4 bg-white/90 text-black px-4 py-2 rounded-xl text-sm font-bold shadow-sm">צבע מהטבע</div>
                </div>
                <div class="img-straight h-[350px] md:h-full relative md:-mt-12 cursor-pointer shadow-2xl" onclick="openLightbox('04.webp')">
                    <img src="04.webp" alt="עומק וטקסטורה">
                    <div class="absolute bottom-4 right-4 bg-white/90 text-black px-4 py-2 rounded-xl text-sm font-bold shadow-sm">עומק וטקסטורה</div>
                </div>
                <div class="img-straight h-[350px] md:h-full relative cursor-pointer" onclick="openLightbox('05.webp')">
                    <img src="05.webp" alt="אומנות עתיקה">
                    <div class="absolute bottom-4 right-4 bg-white/90 text-black px-4 py-2 rounded-xl text-sm font-bold shadow-sm">אומנות עתיקה</div>
                </div>
            </div>
            <div class="text-center text-gray-600 leading-relaxed text-lg font-normal max-w-2xl mx-auto pt-8">
                <p>"פיגמנטים טבעיים הם צבע שנולד מהאדמה – אבנים טחונות, מינרלים, אדמה וזמן. בטדלקט הם לא “צובעים” את הקיר, אלא נטמעים בו, נושמים איתו ומתיישנים ביופי. זו לא שכבה מעל החומר — זו זהות שנכנסת פנימה. צבע שיש בו עומק, שקט ואמת."</p>
            </div>
        </section>

        <!-- גלריית עבודות משולבת -->
        <section class="space-y-8">
            <h3 class="text-2xl font-bold text-center border-b-2 border-tadelakt-beige pb-4 w-fit mx-auto px-10 text-gray-400 uppercase tracking-widest">גלריית עבודות</h3>
            
            <!-- התמונות המקומיות שלך (06-18) -->
            <div class="grid grid-cols-2 md:grid-cols-5 gap-4 px-4" id="bottom-gallery">
                <!-- יתמלא על ידי JS -->
            </div>

            <!-- תיקיות הפרויקטים מגוגל שיטס -->
            <div class="text-center pt-16 pb-4">
                <p class="text-gray-400 text-sm tracking-widest uppercase">פרויקטים נבחרים מהאקסל</p>
            </div>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-6 px-4" id="category-grid">
                <!-- יתמלא מהאקסל -->
            </div>
        </section>

        <section id="contact-form" class="relative">
            <div class="absolute left-1/2 top-1/2 -translate-x-1/2 -translate-y-1/2 w-full max-w-5xl h-full bg-tadelakt-beige blur-[100px] rounded-full -z-10"></div>
            <div class="glass-card p-6 md:p-14 rounded-[2rem] max-w-4xl mx-auto relative z-10 bg-white/80 overflow-hidden">
                <div class="text-center mb-10">
                    <h3 class="text-3xl md:text-5xl font-bold serif mb-3 text-[#2d2d2d]">בואו נדבר על <span class="text-gradient-tadelakt">הפרויקט הבא</span></h3>
                    <p class="text-gray-500 text-lg">השאירו פרטים ואשמח לחזור אליכם</p>
                </div>
                <form id="contactForm" onsubmit="submitToGoogleSheets(event)" class="space-y-6">
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="space-y-2">
                            <label class="text-gray-600 text-sm mr-2 font-bold">שם מלא</label>
                            <input type="text" name="name" required class="w-full input-light rounded-xl p-4" placeholder="שם ומשפחה">
                        </div>
                        <div class="space-y-2">
                            <label class="text-gray-600 text-sm mr-2 font-bold">טלפון</label>
                            <input type="tel" name="phone" required class="w-full input-light rounded-xl p-4" placeholder="05X-XXXXXXX">
                        </div>
                    </div>
                    <div class="space-y-2">
                        <label class="text-gray-600 text-sm mr-2 font-bold">נושא / סוג פרויקט</label>
                        <input type="text" name="projectType" class="w-full input-light rounded-xl p-4" placeholder="שחזור, שימור, עיצוב חדש...">
                    </div>
                    <div class="space-y-2">
                        <label class="text-gray-600 text-sm mr-2 font-bold">הודעה</label>
                        <textarea name="message" rows="5" class="w-full input-light rounded-xl p-4" placeholder="פרטו בקצרה על הפרויקט..."></textarea>
                    </div>
                    <button type="submit" id="submit-btn" class="w-full bg-gradient-tadelakt text-white font-bold text-xl py-4 rounded-xl shadow-lg transition-all mt-4 flex items-center justify-center gap-2">
                        <span>שלח הודעה</span><i data-lucide="send" class="w-5 h-5"></i>
                    </button>
                </form>
            </div>
        </section>
    </main>

    <footer class="bg-white py-12 border-t border-gray-100 mt-10">
        <div class="max-w-7xl mx-auto px-4 flex flex-col items-center gap-6 text-center">
            <div class="text-4xl font-bold serif text-gradient-tadelakt">Niv Dahan</div>
            
            <div class="flex flex-col md:flex-row gap-4 md:gap-8 mt-2 w-full justify-center">
                <!-- שורה 1 -->
                <div class="flex justify-center gap-8 footer-social-group">
                    <a href="                                         " target="_blank" class="group flex flex-col items-center gap-2">
                        <div class="bg-gray-50 p-4 rounded-full group-hover:bg-pink-100 transition shadow-sm"><i data-lucide="instagram" class="w-6 h-6"></i></div>
                        <span class="text-xs text-gray-500">אינסטגרם</span>
                    </a>
                    <a href="https://www.facebook.com/niv.aviv.5" target="_blank" class="group flex flex-col items-center gap-2">
                        <div class="bg-gray-50 p-4 rounded-full group-hover:bg-blue-100 transition shadow-sm"><i data-lucide="facebook" class="w-6 h-6"></i></div>
                        <span class="text-xs text-gray-500">פייסבוק</span>
                    </a>
                </div>
                <!-- שורה 2 -->
                <div class="flex justify-center gap-8 footer-social-group">
                    <a href="                                        " target="_blank" class="group flex flex-col items-center gap-2">
                        <div class="bg-gray-50 p-4 rounded-full group-hover:bg-gray-200 transition shadow-sm"><i data-lucide="at-sign" class="w-6 h-6"></i></div>
                        <span class="text-xs text-gray-500">Threads</span>
                    </a>
                    <a href="https://api.whatsapp.com/send/?phone=972535379988" target="_blank" class="group flex flex-col items-center gap-2">
                        <div class="bg-gray-50 p-4 rounded-full group-hover:bg-green-100 transition shadow-sm"><i data-lucide="message-circle" class="w-6 h-6"></i></div>
                        <span class="text-xs text-gray-500">וואטסאפ</span>
                    </a>
                    <a href="tel:+972535379988" class="group flex flex-col items-center gap-2">
                        <div class="bg-gray-50 p-4 rounded-full group-hover:bg-orange-50 transition shadow-sm"><i data-lucide="phone" class="w-6 h-6"></i></div>
                        <span class="text-xs text-gray-500">חייגו</span>
                    </a>
                </div>
            </div>
            <p class="text-gray-400 text-sm mt-4">© כל הזכויות שמורות לניב דהן 2026</p>
        </div>
    </footer>

    <!-- מודלים -->
    <div id="project-modal" class="fixed inset-0 z-[2500] hidden bg-white overflow-y-auto">
        <div class="sticky top-0 bg-white/90 backdrop-blur-md p-6 flex justify-between items-center border-b z-50">
            <h4 id="project-modal-title" class="text-2xl font-bold serif text-tadelakt-ochre"></h4>
            <button onclick="closeProjectModal()" class="p-3 bg-gray-100 rounded-full hover:bg-red-50 transition"><i data-lucide="x"></i></button>
        </div>
        <div class="max-w-7xl mx-auto p-6 grid grid-cols-2 md:grid-cols-3 gap-4" id="project-modal-grid"></div>
    </div>

    <div id="lightbox-modal" class="fixed inset-0 bg-white/95 z-[3000] hidden flex items-center justify-center p-4 cursor-pointer backdrop-blur-md" onclick="closeLightbox()">
        <button class="absolute top-5 right-5 bg-gray-200 p-3 rounded-full"><i data-lucide="x"></i></button>
        <div id="lightbox-content" class="max-w-full max-h-[90vh]" onclick="event.stopPropagation()">
            <img id="lightbox-img" src="" class="rounded-2xl shadow-2xl hidden">
        </div>
    </div>

    <script>
        const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbyqbenjkSNnGq7hjh2GlYSazgkLd5HFj_kp79u7N1pwrR-choqD4GaNAt7G0lMoigKiaw/exec';
        let projectsData = [];

        // 1. טעינת תמונות מקומיות 06-18
        function initGallery() {
            const container = document.getElementById('bottom-gallery');
            const images = ['06.webp','07.webp','08.webp','09.webp','10.webp','11.webp','12.webp','13.webp','14.webp','15.webp','16.webp','17.webp','18.webp'];
            container.innerHTML = images.map((img, i) => `
                <div class="img-straight h-32 md:h-64 cursor-pointer bg-gray-100" onclick="openLightbox('${img}')">
                    <img src="${img}" alt="עבודה ${i+6}" loading="lazy">
                </div>
            `).join('');
        }

        // 2. טעינה מהאקסל (תיקיות)
        async function loadSheetData() {
            try {
                const res = await fetch(SCRIPT_URL);
                const data = await res.json();
                projectsData = data.projects || [];
                renderCategories();
            } catch (e) { console.error("Sheet Error", e); }
        }

        // פונקציית עזר לחילוץ מזהה יוטיוב
        function getYouTubeId(url) {
            if (!url) return null;
            const regExp = /^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|&v=)([^#&?]*).*/;
            const match = url.match(regExp);
            return (match && match[2].length === 11) ? match[2] : null;
        }

        // פונקציית יצירת הקישור עם הגדרות אוטומטיות (השתקה + לופ)
        function formatMediaUrl(url, isVid = false) {
            if (!url) return '01.webp';
            
            // בדיקת יוטיוב
            const ytId = getYouTubeId(url);
            if (ytId) {
                if (isVid) {
                    return `https://www.youtube.com/embed/${ytId}?autoplay=1&mute=1&loop=1&playlist=${ytId}&controls=0&showinfo=0&rel=0`;
                }
                return `https://img.youtube.com/vi/${ytId}/hqdefault.jpg`;
            }

            // לוגיקה לגוגל דרייב
            let id = '';
            if (url.includes('id=')) id = url.split('id=')[1].split('&')[0];
            else if (url.includes('/d/')) id = url.split('/d/')[1].split('/')[0];
            
            if (id) {
                return isVid ? `https://drive.google.com/uc?id=${id}&export=download` : `https://drive.google.com/thumbnail?id=${id}&sz=w800-rw`;
            }
            return url;
        }

        function renderCategories() {
            const grid = document.getElementById('category-grid');
            const groups = projectsData.reduce((acc, p) => {
                const name = p.name || 'עבודות נוספות';
                if (!acc[name]) acc[name] = [];
                acc[name].push(p);
                return acc;
            }, {});

            grid.innerHTML = Object.keys(groups).map(name => {
                const items = groups[name];
                const cover = formatMediaUrl(items[0].url);
                return `
                    <div class="img-straight h-64 md:h-80 cursor-pointer group" onclick="openProjectModal('${name}')">
                        <img src="${cover}" loading="lazy">
                        <div class="category-overlay absolute inset-0 flex flex-col justify-end p-4 text-white">
                            <span class="text-[10px] uppercase tracking-widest opacity-70">${items.length} פריטים</span>
                            <h4 class="text-lg font-bold">${name}</h4>
                        </div>
                    </div>
                `;
            }).join('');
            lucide.createIcons();
        }

        function openProjectModal(name) {
            const modal = document.getElementById('project-modal');
            const grid = document.getElementById('project-modal-grid');
            const titleEl = document.getElementById('project-modal-title');
            
            if(titleEl) titleEl.innerText = name;
            
            const filtered = projectsData.filter(p => (p.name || 'עבודות נוספות') === name);
            
            grid.innerHTML = filtered.map(p => {
                const ytId = getYouTubeId(p.url);
                // בדיקה אם זה וידאו ישיר (סיומת קובץ) או וידאו מדרייב/תיקייה
                const isDirectVid = p.url.match(/\.(mp4|webm|ogg|mov)$/i) || (p.description || '').includes('וידאו');
                
                if (ytId) {
                    // יוטיוב - ניגון אוטומטי מושתק
                    const embedUrl = formatMediaUrl(p.url, true);
                    return `
                        <div class="img-straight h-48 md:h-72 relative cursor-pointer" onclick="openLightbox('${p.url}', 'youtube')">
                            <iframe src="${embedUrl}" class="w-full h-full border-none pointer-events-none" allow="autoplay; encrypted-media"></iframe>
                        </div>`;
                } else if (isDirectVid) {
                    // וידאו מהתיקייה או דרייב - ניגון אוטומטי מושתק
                    const videoUrl = formatMediaUrl(p.url, true);
                    return `
                        <div class="img-straight h-48 md:h-72 relative cursor-pointer" onclick="openLightbox('${p.url}', 'video')">
                            <video src="${videoUrl}" autoplay muted loop playsinline class="w-full h-full object-cover"></video>
                        </div>`;
                } else {
                    // תמונה רגילה
                    const thumbUrl = formatMediaUrl(p.url, false);
                    return `
                        <div class="img-straight h-48 md:h-72 cursor-pointer relative group" onclick="openLightbox('${p.url}', 'image')">
                            <img src="${thumbUrl}" class="w-full h-full object-cover transition-transform duration-700 group-hover:scale-105">
                        </div>`;
                }
            }).join('');
            
            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden';
            if (window.lucide) lucide.createIcons();
        }

        function closeProjectModal() {
            document.getElementById('project-modal').classList.add('hidden');
            // עצירת כל הוידאו בתוך המודל כשסוגרים אותו
            document.getElementById('project-modal-grid').innerHTML = '';
            document.body.style.overflow = 'auto';
        }

        function openLightbox(src, type = 'image') {
            const modal = document.getElementById('lightbox-modal');
            const content = document.getElementById('lightbox-content');
            
            let htmlContent = '';

            if (type === 'youtube') {
                const embedUrl = formatMediaUrl(src, true).replace('mute=1', 'mute=0'); // בתוך הלייטבוקס נרצה סאונד
                htmlContent = `<iframe src="${embedUrl}" class="w-[90vw] h-[50vw] max-w-4xl max-h-[80vh] rounded-2xl shadow-2xl border-none" allow="autoplay; encrypted-media" allowfullscreen></iframe>`;
            } else if (type === 'video') {
                const videoUrl = formatMediaUrl(src, true);
                htmlContent = `<video src="${videoUrl}" controls autoplay playsinline class="max-w-full max-h-[90vh] rounded-2xl"></video>`;
            } else {
                const imgUrl = formatMediaUrl(src, false);
                htmlContent = `<img src="${imgUrl}" class="max-w-full max-h-[90vh] rounded-2xl shadow-2xl">`;
            }

            content.innerHTML = htmlContent;
            modal.classList.remove('hidden');
            modal.classList.add('flex');
            document.body.style.overflow = 'hidden';
        }

        function closeLightbox() {
            document.getElementById('lightbox-modal').classList.add('hidden');
            document.getElementById('lightbox-content').innerHTML = '';
            document.body.style.overflow = 'auto';
        }

        async function submitToGoogleSheets(e) {
            e.preventDefault();
            const btn = document.getElementById('submit-btn');
            const original = btn.innerHTML;
            btn.innerHTML = 'שולח... <i data-lucide="loader-2" class="animate-spin ml-2"></i>';
            btn.disabled = true;
            lucide.createIcons();
            try {
                await fetch(SCRIPT_URL, { method: 'POST', mode: 'no-cors', body: JSON.stringify(Object.fromEntries(new FormData(e.target))) });
                showToast('ההודעה נשלחה בהצלחה!');
                e.target.reset();
            } catch (e) { showToast('שגיאה בשליחה.'); }
            btn.innerHTML = original; btn.disabled = false; lucide.createIcons();
        }

        function showToast(msg) {
            const t = document.getElementById('toast');
            document.getElementById('toast-msg').innerText = msg;
            t.classList.add('show');
            setTimeout(() => t.classList.remove('show'), 4000);
        }

        window.onload = () => {
            initGallery();
            loadSheetData();
            lucide.createIcons();
        };
    </script>
</body>
</html>
